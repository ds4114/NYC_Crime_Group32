<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Data | NYC Crime</title>
  <meta name="description" content="Chapter 6 Data | NYC Crime" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Data | NYC Crime" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Data | NYC Crime" />
  
  
  

<meta name="author" content="Group 32: Abhiram Gaddam, Faizan Dogar, Devan Samant" />


<meta name="date" content="2022-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="proposal.html"/>
<link rel="next" href="results.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYC Crime</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="outlineworknotes.html"><a href="outlineworknotes.html"><i class="fa fa-check"></i><b>2</b> Outline/Work/Notes</a></li>
<li class="chapter" data-level="3" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>3</b> Tasks</a></li>
<li class="chapter" data-level="4" data-path="next-steps-note-2022-11-13.html"><a href="next-steps-note-2022-11-13.html"><i class="fa fa-check"></i><b>4</b> Next Steps Note 2022-11-13</a></li>
<li class="chapter" data-level="5" data-path="proposal.html"><a href="proposal.html"><i class="fa fa-check"></i><b>5</b> Proposal</a>
<ul>
<li class="chapter" data-level="5.1" data-path="proposal.html"><a href="proposal.html#research-topic"><i class="fa fa-check"></i><b>5.1</b> Research topic</a></li>
<li class="chapter" data-level="5.2" data-path="proposal.html"><a href="proposal.html#data-availability"><i class="fa fa-check"></i><b>5.2</b> Data availability</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="proposal.html"><a href="proposal.html#content"><i class="fa fa-check"></i><b>5.2.1</b> <em>Content</em></a></li>
<li class="chapter" data-level="5.2.2" data-path="proposal.html"><a href="proposal.html#who-collects-the-data"><i class="fa fa-check"></i><b>5.2.2</b> <em>Who Collects The Data</em></a></li>
<li class="chapter" data-level="5.2.3" data-path="proposal.html"><a href="proposal.html#format-and-importation"><i class="fa fa-check"></i><b>5.2.3</b> <em>Format and Importation</em></a></li>
<li class="chapter" data-level="5.2.4" data-path="proposal.html"><a href="proposal.html#updates"><i class="fa fa-check"></i><b>5.2.4</b> <em>Updates</em></a></li>
<li class="chapter" data-level="5.2.5" data-path="proposal.html"><a href="proposal.html#expected-challenges"><i class="fa fa-check"></i><b>5.2.5</b> <em>Expected Challenges</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>6</b> Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data.html"><a href="data.html#sources"><i class="fa fa-check"></i><b>6.1</b> Sources</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data.html"><a href="data.html#data-loading"><i class="fa fa-check"></i><b>6.1.1</b> Data Loading</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data.html"><a href="data.html#cleaning-transformation"><i class="fa fa-check"></i><b>6.2</b> Cleaning / transformation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data.html"><a href="data.html#creating-a-new-column-to-bucket-crimes"><i class="fa fa-check"></i><b>6.2.1</b> Creating a new column to bucket crimes</a></li>
<li class="chapter" data-level="6.2.2" data-path="data.html"><a href="data.html#datetime"><i class="fa fa-check"></i><b>6.2.2</b> Date/Time</a></li>
<li class="chapter" data-level="6.2.3" data-path="data.html"><a href="data.html#geolocation-fields"><i class="fa fa-check"></i><b>6.2.3</b> GeoLocation Fields</a></li>
<li class="chapter" data-level="6.2.4" data-path="data.html"><a href="data.html#other-derivations"><i class="fa fa-check"></i><b>6.2.4</b> Other Derivations</a></li>
<li class="chapter" data-level="6.2.5" data-path="data.html"><a href="data.html#filter-table-for-relevance"><i class="fa fa-check"></i><b>6.2.5</b> Filter Table for Relevance</a></li>
<li class="chapter" data-level="6.2.6" data-path="data.html"><a href="data.html#select-and-rename-columns-in-a-usuable-table"><i class="fa fa-check"></i><b>6.2.6</b> Select and Rename Columns in a Usuable Table</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data.html"><a href="data.html#missing-value-analysis"><i class="fa fa-check"></i><b>6.3</b> Missing value analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>7</b> Results</a>
<ul>
<li class="chapter" data-level="7.1" data-path="results.html"><a href="results.html#planning-notes"><i class="fa fa-check"></i><b>7.1</b> Planning Notes</a></li>
<li class="chapter" data-level="7.2" data-path="results.html"><a href="results.html#crime-category-and-demographic-analysis"><i class="fa fa-check"></i><b>7.2</b> Crime category and Demographic analysis</a></li>
<li class="chapter" data-level="7.3" data-path="results.html"><a href="results.html#time-series"><i class="fa fa-check"></i><b>7.3</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="location-analysis.html"><a href="location-analysis.html"><i class="fa fa-check"></i><b>8</b> Location Analysis</a></li>
<li class="chapter" data-level="9" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>9</b> Interactive component</a>
<ul>
<li class="chapter" data-level="9.1" data-path="interactive-component.html"><a href="interactive-component.html#test"><i class="fa fa-check"></i><b>9.1</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>10</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC Crime</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Data<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="data.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="data.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb6-2"><a href="data.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geosphere)</span></code></pre></div>
<pre><code>## Warning: package &#39;geosphere&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(redav) <span class="co">#remotes::install_github(&quot;jtr13/redav&quot;)</span></span>
<span id="cb8-2"><a href="data.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="data.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Unused Libraries:</span></span>
<span id="cb8-4"><a href="data.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(readr)</span></span></code></pre></div>
<div id="sources" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Sources<a href="data.html#sources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>TODO - WRITEUP/repeate proposal</p>
<div id="data-loading" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Data Loading<a href="data.html#data-loading" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group32 - This file has been added to gitignore so it will not be uploaded. So we are on the same page and can run the same code, add the csv to your local project folder in a new subfolder &quot;data&quot;. </span></span>
<span id="cb9-2"><a href="data.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#df_raw &lt;- read_csv(&#39;./data/NYPD_Complaint_Data_Current__Year_To_Date_.csv&#39;)</span></span>
<span id="cb9-3"><a href="data.html#cb9-3" aria-hidden="true" tabindex="-1"></a>df_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;./data/NYPD_Complaint_Data_Current__Year_To_Date_.csv&#39;</span></span>
<span id="cb9-4"><a href="data.html#cb9-4" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">col_types=</span> <span class="fu">cols</span>(</span>
<span id="cb9-5"><a href="data.html#cb9-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">CMPLNT_NUM =</span> <span class="fu">col_character</span>() <span class="co">#was loading as number so numbers with letters were showing as null</span></span>
<span id="cb9-6"><a href="data.html#cb9-6" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb9-7"><a href="data.html#cb9-7" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb9-8"><a href="data.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df_raw)</span></span>
<span id="cb9-9"><a href="data.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#head(df_raw)</span></span></code></pre></div>
</div>
</div>
<div id="cleaning-transformation" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Cleaning / transformation<a href="data.html#cleaning-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>–TODO
1) Re-categorize and clean Offense Type
2) Derive Date/Time fields
3)</p>
<div id="offense-type" class="section level4 hasAnchor" number="6.2.0.1">
<h4><span class="header-section-number">6.2.0.1</span> Offense Type<a href="data.html#offense-type" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="imputing-null-values" class="section level4 hasAnchor" number="6.2.0.2">
<h4><span class="header-section-number">6.2.0.2</span> Imputing null values<a href="data.html#imputing-null-values" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For crime type (Abhi) - There are 5 values with missing “OFNS_DESC”. Since they have valid PD_CD and PD_DESC, we can impute these values from other columns with the same PD_CD
two values are for obscenity - 594 PD_CD. categorized as sex crimes
one values for crime pos weap - 797 PD_CD. categorized as dangerous weapons
one value for “place false bomb” - 648 PD_CD. No other examples of this crime. Ignore?
one value for “noise” - 872 PD_CD. No other examples of this crime. Ignore?</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data.html#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_raw</span>
<span id="cb10-2"><a href="data.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="data.html#cb10-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>OFNS_DESC[df<span class="sc">$</span>CMPLNT_NUM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;248613125&quot;</span>, <span class="st">&quot;248290778&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;SEX CRIMES&quot;</span></span>
<span id="cb10-4"><a href="data.html#cb10-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>OFNS_DESC[df<span class="sc">$</span>CMPLNT_NUM <span class="sc">%in%</span> (<span class="st">&quot;246605653&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;DANGEROUS WEAPONS&quot;</span></span></code></pre></div>
</div>
<div id="creating-a-new-column-to-bucket-crimes" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Creating a new column to bucket crimes<a href="data.html#creating-a-new-column-to-bucket-crimes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data.html#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="data.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CRIME_CAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-3"><a href="data.html#cb11-3" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RAPE&quot;</span>, <span class="st">&quot;SEX CRIMES&quot;</span>, <span class="st">&quot;HARRASSMENT 2&quot;</span>, <span class="st">&quot;FELONY SEX CRIMES&quot;</span>, <span class="st">&quot;PROSTITUTION &amp; RELATED OFFENSES&quot;</span>) <span class="sc">~</span> <span class="st">&quot;SEX CRIMES&quot;</span>,</span>
<span id="cb11-4"><a href="data.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DANGEROUS DRUGS&quot;</span>,<span class="st">&quot;CANNABIS RELATED OFFENSES&quot;</span>,<span class="st">&quot;INTOXICATED &amp; IMPAIRED DRIVING&quot;</span>,<span class="st">&quot;ALCOHOLIC BEVERAGE CONTROL LAW&quot;</span>,<span class="st">&quot;INTOXICATED/IMPAIRED DRIVING&quot;</span>) <span class="sc">~</span> <span class="st">&quot;DRUG AND ALCOHOL RELATED&quot;</span>,</span>
<span id="cb11-5"><a href="data.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ROBBERY&quot;</span>,<span class="st">&quot;GRAND LARCENY&quot;</span>,<span class="st">&quot;THEFT-FRAUD&quot;</span>,<span class="st">&quot;PETIT LARCENY&quot;</span>,<span class="st">&quot;BURGLARY&quot;</span>,<span class="st">&quot;GRAND LARCENY OF MOTOR VEHICLE&quot;</span>,<span class="st">&quot;POSSESSION OF STOLEN PROPERTY&quot;</span>,<span class="st">&quot;THEFT OF SERVICES&quot;</span>,<span class="st">&quot;BURGLAR&#39;S TOOLS&quot;</span>,<span class="st">&quot;PETIT LARCENY OF MOTOR VEHICLE&quot;</span>,<span class="st">&quot;OTHER OFFENSES RELATED TO THEF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;THEFT OR BURGLARY&quot;</span>,</span>
<span id="cb11-6"><a href="data.html#cb11-6" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DANGEROUS WEAPONS&quot;</span>,<span class="st">&quot;MURDER &amp; NON-NEGL. MANSLAUGHTER&quot;</span>,<span class="st">&quot;KIDNAPPING &amp; RELATED OFFENSES&quot;</span>,<span class="st">&quot;HOMICIDE-NEGLIGENT,UNCLASSIFIE&quot;</span>,<span class="st">&quot;HOMICIDE-NEGLIGENT-VEHICLE&quot;</span>,<span class="st">&quot;KIDNAPPING&quot;</span>,<span class="st">&quot;FELONY ASSAULT&quot;</span>,<span class="st">&quot;ARSON&quot;</span>,<span class="st">&quot;ASSAULT 3 &amp; RELATED OFFENSES&quot;</span>,<span class="st">&quot;UNLAWFUL POSS. WEAP. ON SCHOOL&quot;</span>,<span class="st">&quot;MURDER &amp; NON-NEGL. MANSLAUGHTER&quot;</span>) <span class="sc">~</span> <span class="st">&quot;MAJOR VIOLENT CRIMES&quot;</span>,</span>
<span id="cb11-7"><a href="data.html#cb11-7" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;CRIMINAL MISCHIEF &amp; RELATED OF&quot;</span>,<span class="st">&quot;UNAUTHORIZED USE OF A VEHICLE&quot;</span>,<span class="st">&quot;FRAUDS&quot;</span>,<span class="st">&quot;OFFENSES AGAINST PUBLIC SAFETY&quot;</span>,<span class="st">&quot;DISORDERLY CONDUCT&quot;</span>,<span class="st">&quot;JOSTLING&quot;</span>,<span class="st">&quot;DISRUPTION OF A RELIGIOUS SERV&quot;</span>,<span class="st">&quot;ESCAPE 3&quot;</span>,<span class="st">&quot;OFF. AGNST PUB ORD SENSBLTY &amp;&quot;</span>,<span class="st">&quot;CRIMINAL TRESPASS&quot;</span>,<span class="st">&quot;VEHICLE AND TRAFFIC LAWS&quot;</span>,<span class="st">&quot;GAMBLING&quot;</span>,<span class="st">&quot;OFFENSES AGAINST THE PERSON&quot;</span>,<span class="st">&quot;OFFENSES INVOLVING FRAUD&quot;</span>,<span class="st">&quot;FRAUDULENT ACCOSTING&quot;</span>,<span class="st">&quot;ANTICIPATORY OFFENSES&quot;</span>,<span class="st">&quot;LOITERING/GAMBLING (CARDS, DIC&quot;</span>) <span class="sc">~</span> <span class="st">&quot;FRAUD/GAMBLING AND MISC&quot;</span>,</span>
<span id="cb11-8"><a href="data.html#cb11-8" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;NYS LAWS-UNCLASSIFIED FELONY&quot;</span>,<span class="st">&quot;MISCELLANEOUS PENAL LAW&quot;</span>,<span class="st">&quot;FORGERY&quot;</span>,<span class="st">&quot;OFFENSES AGAINST PUBLIC ADMINI&quot;</span>,<span class="st">&quot;CHILD ABANDONMENT/NON SUPPORT&quot;</span>,<span class="st">&quot;NYS LAWS-UNCLASSIFIED VIOLATION&quot;</span>,<span class="st">&quot;OTHER STATE LAWS&quot;</span>,<span class="st">&quot;OTHER STATE LAWS (NON PENAL LAW)&quot;</span>,<span class="st">&quot;NEW YORK CITY HEALTH CODE&quot;</span>,<span class="st">&quot;ADMINISTRATIVE CODE&quot;</span>,<span class="st">&quot;OTHER STATE LAWS (NON PENAL LA&quot;</span>,<span class="st">&quot;AGRICULTURE &amp; MRKTS LAW-UNCLASSIFIED&quot;</span>,<span class="st">&quot;ENDAN WELFARE INCOMP&quot;</span>,<span class="st">&quot;OFFENSES RELATED TO CHILDREN&quot;</span>) <span class="sc">~</span><span class="st">&quot;OTHER&quot;</span>))</span>
<span id="cb11-9"><a href="data.html#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="data.html#cb11-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>CRIME_CAT[df<span class="sc">$</span>CMPLNT_NUM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;243170965&quot;</span>, <span class="st">&quot;245874611&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;OTHER&quot;</span></span>
<span id="cb11-11"><a href="data.html#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="data.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#No Nulls</span></span>
<span id="cb11-13"><a href="data.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df[is.na(df$CRIME_CAT),])</span></span></code></pre></div>
</div>
<div id="datetime" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Date/Time<a href="data.html#datetime" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="cleaning-null-valuesranges" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Cleaning null values/ranges<a href="data.html#cleaning-null-valuesranges" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Per the data dictionary, there is both a “from_date” and a “to_date” when the exact time is unknown. There is also a “report date” for when the crime was reported. Using these fields in conjunction, we can derive a new clean field that is the assumed date of the incident. Assumptions: When there is a range, we will use the “from” date only because is populated well and will on average approximate the frequency of crime over time; when from_date is null, we will use the report_date (does not occur often, see Missing Data Analysis below).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data.html#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="data.html#cb12-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="data.html#cb12-3" aria-hidden="true" tabindex="-1"></a>         <span class="co">#use from date and report date if null. If to_date then just use from date and we can argue it averages out since new reports will start as other end</span></span>
<span id="cb12-4"><a href="data.html#cb12-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Incident_Date_raw =</span> <span class="fu">case_when</span> (<span class="fu">is.null</span>(CMPLNT_FR_DT) <span class="sc">~</span> RPT_DT</span>
<span id="cb12-5"><a href="data.html#cb12-5" aria-hidden="true" tabindex="-1"></a>                                     ,CMPLNT_FR_DT <span class="sc">==</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> RPT_DT</span>
<span id="cb12-6"><a href="data.html#cb12-6" aria-hidden="true" tabindex="-1"></a>                                     ,<span class="cn">TRUE</span>  <span class="sc">~</span> CMPLNT_FR_DT</span>
<span id="cb12-7"><a href="data.html#cb12-7" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb12-8"><a href="data.html#cb12-8" aria-hidden="true" tabindex="-1"></a>         <span class="co">#flag if estimated (ie from date is null or to date is populated)</span></span>
<span id="cb12-9"><a href="data.html#cb12-9" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">Incident_Date_Estimated_Flag =</span> <span class="fu">case_when</span> ( <span class="fu">is.null</span>(CMPLNT_FR_DT) <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb12-10"><a href="data.html#cb12-10" aria-hidden="true" tabindex="-1"></a>                                                     ,CMPLNT_FR_DT <span class="sc">==</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb12-11"><a href="data.html#cb12-11" aria-hidden="true" tabindex="-1"></a>                                                     ,<span class="sc">!</span><span class="fu">is.null</span>(CMPLNT_TO_DT) <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb12-12"><a href="data.html#cb12-12" aria-hidden="true" tabindex="-1"></a>                                                     ,CMPLNT_TO_DT <span class="sc">!=</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb12-13"><a href="data.html#cb12-13" aria-hidden="true" tabindex="-1"></a>                                                     ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;N&#39;</span></span>
<span id="cb12-14"><a href="data.html#cb12-14" aria-hidden="true" tabindex="-1"></a>                                                   )</span>
<span id="cb12-15"><a href="data.html#cb12-15" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb12-16"><a href="data.html#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="data.html#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to times</span></span>
<span id="cb12-18"><a href="data.html#cb12-18" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb12-19"><a href="data.html#cb12-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb12-20"><a href="data.html#cb12-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#creating date and time together for lubridate</span></span>
<span id="cb12-21"><a href="data.html#cb12-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">Incident_Date =</span> <span class="fu">as.Date</span>(Incident_Date_raw, <span class="at">format =</span> <span class="st">&#39;%m/%d/%Y&#39;</span>)</span>
<span id="cb12-22"><a href="data.html#cb12-22" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">Incident_Datetime =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(Incident_Date_raw,CMPLNT_FR_TM), <span class="at">format =</span> <span class="st">&#39;%m/%d/%Y %H:%M:%S&#39;</span>)</span>
<span id="cb12-23"><a href="data.html#cb12-23" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="data.html#cb12-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb12-25"><a href="data.html#cb12-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Incident_HourTime =</span> <span class="fu">hour</span>(Incident_Datetime) <span class="sc">+</span> <span class="fu">minute</span>(Incident_Datetime)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb12-26"><a href="data.html#cb12-26" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">Incident_Month =</span> <span class="fu">month</span>(Incident_Date)</span>
<span id="cb12-27"><a href="data.html#cb12-27" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">Incident_DayOfWeek =</span> <span class="fu">wday</span>(Incident_Date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-28"><a href="data.html#cb12-28" aria-hidden="true" tabindex="-1"></a>      )</span></code></pre></div>
</div>
</div>
<div id="geolocation-fields" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> GeoLocation Fields<a href="data.html#geolocation-fields" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add column for Columbia location</span></span>
<span id="cb13-2"><a href="data.html#cb13-2" aria-hidden="true" tabindex="-1"></a>CU_Latitude <span class="ot">=</span> <span class="fl">40.807384</span></span>
<span id="cb13-3"><a href="data.html#cb13-3" aria-hidden="true" tabindex="-1"></a>CU_Longitude <span class="ot">=</span> <span class="sc">-</span><span class="fl">73.963036</span></span>
<span id="cb13-4"><a href="data.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="data.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#df_test = df[1:10,]</span></span>
<span id="cb13-6"><a href="data.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#df_test$dist_to_CU &lt;- apply(df_test, 1, function(x)distm(c(x[which( colnames(df)==&quot;Longitude&quot;)],x[which(colnames(df)==&quot;Latitude&quot;)]),c(x[which( colnames(df)==&quot;CU_Longitude&quot;)],x[which( colnames(df)==&quot;CU_Latitude&quot;)]),fun = distGeo))</span></span>
<span id="cb13-7"><a href="data.html#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="data.html#cb13-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>dist_to_CU <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(x)<span class="fu">distm</span>(</span>
<span id="cb13-9"><a href="data.html#cb13-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(x[<span class="fu">which</span>( <span class="fu">colnames</span>(df)<span class="sc">==</span><span class="st">&quot;Longitude&quot;</span>)],x[<span class="fu">which</span>(<span class="fu">colnames</span>(df)<span class="sc">==</span><span class="st">&quot;Latitude&quot;</span>)])</span>
<span id="cb13-10"><a href="data.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  ,<span class="fu">c</span>(CU_Longitude,CU_Latitude)</span>
<span id="cb13-11"><a href="data.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">fun =</span> distGeo)</span>
<span id="cb13-12"><a href="data.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>–#TODO can we speed this up? Takes about 5 mins to run</p>
</div>
<div id="other-derivations" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Other Derivations<a href="data.html#other-derivations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we will add additional fields for more classification
–#TODO add more description</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data.html#cb14-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>LOC_OF_OCCUR_DESC[df<span class="sc">$</span>LOC_OF_OCCUR_DESC<span class="sc">==</span><span class="st">&quot;(null)&quot;</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb14-2"><a href="data.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="data.html#cb14-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="data.html#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb14-5"><a href="data.html#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="co">#get a flag for outside vs inside</span></span>
<span id="cb14-6"><a href="data.html#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Inside_Outside =</span> <span class="fu">case_when</span> ( </span>
<span id="cb14-7"><a href="data.html#cb14-7" aria-hidden="true" tabindex="-1"></a>                   LOC_OF_OCCUR_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;FRONT OF&quot;</span> , <span class="st">&quot;OPPOSITE OF&quot;</span> , <span class="st">&quot;REAR OF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;OUTSIDE&quot;</span></span>
<span id="cb14-8"><a href="data.html#cb14-8" aria-hidden="true" tabindex="-1"></a>                  ,LOC_OF_OCCUR_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;INSIDE&quot;</span>) <span class="sc">~</span> <span class="st">&quot;INSIDE&quot;</span></span>
<span id="cb14-9"><a href="data.html#cb14-9" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#,LOC_OF_OCCUR_DESC == &quot;(null)&quot; ~ NULL #TODO -cant figure this out error</span></span>
<span id="cb14-10"><a href="data.html#cb14-10" aria-hidden="true" tabindex="-1"></a>                  ,<span class="cn">TRUE</span> <span class="sc">~</span> LOC_OF_OCCUR_DESC  </span>
<span id="cb14-11"><a href="data.html#cb14-11" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb14-12"><a href="data.html#cb14-12" aria-hidden="true" tabindex="-1"></a>         <span class="co">#if victim was a person (not a business/govt)</span></span>
<span id="cb14-13"><a href="data.html#cb14-13" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">VIC_Individual_Flag =</span> <span class="fu">case_when</span> (</span>
<span id="cb14-14"><a href="data.html#cb14-14" aria-hidden="true" tabindex="-1"></a>                  VIC_SEX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;L&quot;</span>) <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb14-15"><a href="data.html#cb14-15" aria-hidden="true" tabindex="-1"></a>                  ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;N&#39;</span></span>
<span id="cb14-16"><a href="data.html#cb14-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb14-17"><a href="data.html#cb14-17" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="data.html#cb14-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb14-19"><a href="data.html#cb14-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">Complaint_Count =</span> <span class="dv">1</span>     <span class="co">#maybe want to add like a intensity value or something?</span></span>
<span id="cb14-20"><a href="data.html#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO, make this field a little better/check values?</span></span>
<span id="cb14-21"><a href="data.html#cb14-21" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">Premise_Derived =</span> <span class="fu">case_when</span> (</span>
<span id="cb14-22"><a href="data.html#cb14-22" aria-hidden="true" tabindex="-1"></a>           Inside_Outside <span class="sc">==</span> <span class="st">&#39;INSIDE&#39;</span> <span class="sc">~</span> <span class="st">&#39;INSIDE&#39;</span></span>
<span id="cb14-23"><a href="data.html#cb14-23" aria-hidden="true" tabindex="-1"></a>           ,PREM_TYP_DESC <span class="sc">==</span><span class="st">&quot;RESIDENCE - APT. HOUSE&quot;</span> <span class="sc">&amp;</span> (Inside_Outside <span class="sc">==</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">|</span> <span class="fu">is.null</span>(Inside_Outside)) <span class="sc">~</span> <span class="st">&#39;INSIDE&#39;</span></span>
<span id="cb14-24"><a href="data.html#cb14-24" aria-hidden="true" tabindex="-1"></a>           ,<span class="sc">!</span><span class="fu">is.null</span>(PARKS_NM) <span class="sc">&amp;</span> PARKS_NM <span class="sc">!=</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> <span class="st">&#39;PARK&#39;</span></span>
<span id="cb14-25"><a href="data.html#cb14-25" aria-hidden="true" tabindex="-1"></a>           ,PREM_TYP_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;TRANSIT - NYC SUBWAY&quot;</span>,<span class="st">&quot;BUS (NYC TRANSIT)&quot;</span>,<span class="st">&quot;TRANSIT FACILITY (OTHER)&quot;</span>) <span class="sc">~</span> <span class="st">&#39;SUBWAY&#39;</span></span>
<span id="cb14-26"><a href="data.html#cb14-26" aria-hidden="true" tabindex="-1"></a>           ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;STREET&#39;</span></span>
<span id="cb14-27"><a href="data.html#cb14-27" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb14-28"><a href="data.html#cb14-28" aria-hidden="true" tabindex="-1"></a>      )</span></code></pre></div>
</div>
<div id="filter-table-for-relevance" class="section level3 hasAnchor" number="6.2.5">
<h3><span class="header-section-number">6.2.5</span> Filter Table for Relevance<a href="data.html#filter-table-for-relevance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>–#TODO add more description
Date - We only have crimes that took place (as defined by derived field above) in 1/1/2022 onward (this should remove 5%) (Devan)
Crime Type - Use the derived field from above
Location? - Tentative, only look within 3.2km of Columbia (per derived field above)</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data.html#cb15-1" aria-hidden="true" tabindex="-1"></a>df_filter <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(  Incident_Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&#39;2022/01/01&#39;</span>)  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="data.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (</span>
<span id="cb15-3"><a href="data.html#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>CRIME_CAT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;OTHER&quot;</span>)</span>
<span id="cb15-4"><a href="data.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-5"><a href="data.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="data.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO- distance filter?</span></span>
<span id="cb15-7"><a href="data.html#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="data.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df_filter)</span></span>
<span id="cb15-9"><a href="data.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(df_filter$CRIME_CAT)</span></span></code></pre></div>
<p>This improves the results as we will show in the chapter. There are not many records that are excluded (396978 - 364298)</p>
</div>
<div id="select-and-rename-columns-in-a-usuable-table" class="section level3 hasAnchor" number="6.2.6">
<h3><span class="header-section-number">6.2.6</span> Select and Rename Columns in a Usuable Table<a href="data.html#select-and-rename-columns-in-a-usuable-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>–#TODO add more description</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Not required</span></span>
<span id="cb16-2"><a href="data.html#cb16-2" aria-hidden="true" tabindex="-1"></a>df_key_fields <span class="ot">&lt;-</span> df_filter <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="data.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(  </span>
<span id="cb16-4"><a href="data.html#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Basic Info</span></span>
<span id="cb16-5"><a href="data.html#cb16-5" aria-hidden="true" tabindex="-1"></a>       CMPLNT_NUM</span>
<span id="cb16-6"><a href="data.html#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CRM_ATPT_CPTD_CD</span></span>
<span id="cb16-7"><a href="data.html#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Complaint_Count #derived</span></span>
<span id="cb16-8"><a href="data.html#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Date Info</span></span>
<span id="cb16-9"><a href="data.html#cb16-9" aria-hidden="true" tabindex="-1"></a>      ,Incident_Date_raw <span class="co">#derived</span></span>
<span id="cb16-10"><a href="data.html#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Date_Estimated_Flag #derived</span></span>
<span id="cb16-11"><a href="data.html#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Date #derived</span></span>
<span id="cb16-12"><a href="data.html#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Datetime #derived</span></span>
<span id="cb16-13"><a href="data.html#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_HourTime #derived</span></span>
<span id="cb16-14"><a href="data.html#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Month #derived</span></span>
<span id="cb16-15"><a href="data.html#cb16-15" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_DayOfWeek #derived</span></span>
<span id="cb16-16"><a href="data.html#cb16-16" aria-hidden="true" tabindex="-1"></a>      ,CMPLNT_FR_DT</span>
<span id="cb16-17"><a href="data.html#cb16-17" aria-hidden="true" tabindex="-1"></a>      ,CMPLNT_FR_TM</span>
<span id="cb16-18"><a href="data.html#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CMPLNT_TO_DT</span></span>
<span id="cb16-19"><a href="data.html#cb16-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CMPLNT_TO_TM</span></span>
<span id="cb16-20"><a href="data.html#cb16-20" aria-hidden="true" tabindex="-1"></a>      ,RPT_DT</span>
<span id="cb16-21"><a href="data.html#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Location Info</span></span>
<span id="cb16-22"><a href="data.html#cb16-22" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Inside_Outside #derived   #missing a lot (because derived on field below)</span></span>
<span id="cb16-23"><a href="data.html#cb16-23" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CU_Latitude #derived</span></span>
<span id="cb16-24"><a href="data.html#cb16-24" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CU_Longitude #derived</span></span>
<span id="cb16-25"><a href="data.html#cb16-25" aria-hidden="true" tabindex="-1"></a>      ,dist_to_CU  <span class="co">#derived</span></span>
<span id="cb16-26"><a href="data.html#cb16-26" aria-hidden="true" tabindex="-1"></a>      ,Premise_Derived <span class="co">#derived</span></span>
<span id="cb16-27"><a href="data.html#cb16-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,ADDR_PCT_CD</span></span>
<span id="cb16-28"><a href="data.html#cb16-28" aria-hidden="true" tabindex="-1"></a>      ,BORO_NM</span>
<span id="cb16-29"><a href="data.html#cb16-29" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,HADEVELOPT</span></span>
<span id="cb16-30"><a href="data.html#cb16-30" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,HOUSING_PSA</span></span>
<span id="cb16-31"><a href="data.html#cb16-31" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,JURISDICTION_CODE</span></span>
<span id="cb16-32"><a href="data.html#cb16-32" aria-hidden="true" tabindex="-1"></a>      ,JURIS_DESC</span>
<span id="cb16-33"><a href="data.html#cb16-33" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,LOC_OF_OCCUR_DESC    #missing a lot (because of privacy)</span></span>
<span id="cb16-34"><a href="data.html#cb16-34" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PARKS_NM</span></span>
<span id="cb16-35"><a href="data.html#cb16-35" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PATROL_BORO</span></span>
<span id="cb16-36"><a href="data.html#cb16-36" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PD_CD</span></span>
<span id="cb16-37"><a href="data.html#cb16-37" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PD_DESC</span></span>
<span id="cb16-38"><a href="data.html#cb16-38" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PREM_TYP_DESC</span></span>
<span id="cb16-39"><a href="data.html#cb16-39" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,STATION_NAME</span></span>
<span id="cb16-40"><a href="data.html#cb16-40" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,TRANSIT_DISTRICT</span></span>
<span id="cb16-41"><a href="data.html#cb16-41" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,X_COORD_CD</span></span>
<span id="cb16-42"><a href="data.html#cb16-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Y_COORD_CD</span></span>
<span id="cb16-43"><a href="data.html#cb16-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Latitude</span></span>
<span id="cb16-44"><a href="data.html#cb16-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Longitude</span></span>
<span id="cb16-45"><a href="data.html#cb16-45" aria-hidden="true" tabindex="-1"></a>      ,Lat_Lon</span>
<span id="cb16-46"><a href="data.html#cb16-46" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,`New Georeferenced Column`</span></span>
<span id="cb16-47"><a href="data.html#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Crime Info </span></span>
<span id="cb16-48"><a href="data.html#cb16-48" aria-hidden="true" tabindex="-1"></a>      ,CRIME_CAT  <span class="co">#derived</span></span>
<span id="cb16-49"><a href="data.html#cb16-49" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,VIC_Individual_Flag #derived</span></span>
<span id="cb16-50"><a href="data.html#cb16-50" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,KY_CD</span></span>
<span id="cb16-51"><a href="data.html#cb16-51" aria-hidden="true" tabindex="-1"></a>      ,LAW_CAT_CD</span>
<span id="cb16-52"><a href="data.html#cb16-52" aria-hidden="true" tabindex="-1"></a>      ,OFNS_DESC</span>
<span id="cb16-53"><a href="data.html#cb16-53" aria-hidden="true" tabindex="-1"></a>      ,SUSP_AGE_GROUP</span>
<span id="cb16-54"><a href="data.html#cb16-54" aria-hidden="true" tabindex="-1"></a>      ,SUSP_RACE</span>
<span id="cb16-55"><a href="data.html#cb16-55" aria-hidden="true" tabindex="-1"></a>      ,SUSP_SEX</span>
<span id="cb16-56"><a href="data.html#cb16-56" aria-hidden="true" tabindex="-1"></a>      ,VIC_AGE_GROUP</span>
<span id="cb16-57"><a href="data.html#cb16-57" aria-hidden="true" tabindex="-1"></a>      ,VIC_RACE</span>
<span id="cb16-58"><a href="data.html#cb16-58" aria-hidden="true" tabindex="-1"></a>      ,VIC_SEX</span>
<span id="cb16-59"><a href="data.html#cb16-59" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="missing-value-analysis" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Missing value analysis<a href="data.html#missing-value-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we can look at the raw data to see what things look like.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df, <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-4-1.png" width="1440" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df[!is.na(df$TRANSIT_DISTRICT),])</span></span>
<span id="cb18-2"><a href="data.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>( df[ , <span class="sc">!</span><span class="fu">colnames</span>(df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;TRANSIT_DISTRICT&quot;</span>,<span class="st">&quot;HOUSING_PSA&quot;</span>) ] , <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-4-2.png" width="1440" />
These charts are hard to read given the number of columns but it shows that most data is actually populated very well. There are two problem fields causing all of nulls but we can regraph this without those and see that complete cases are at the top. However, this is still not accurate because there are string values in the data that say “(null)” which would appear as populated. In any case, we do not need to clean and evaluate all columns, so let us work off of the new, filtered dataset (see below).
Side Note: We initially noticed the Complaint_Num was null often but this was due to containing alphanumeric characters but readr loaded it as a number only</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df_key_fields, <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-5-1.png" width="1440" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df_key_fields[is.na(df_key_fields$CMPLNT_NUM),])</span></span></code></pre></div>
<p>The filtered data (relevant columns and rows only) is populated very well and this dataset accounts for improperly coded values where “(null)” will appear as NULL properly. We see there are a few blanks for lat/long and thus the related derived field, but otherwise we have a good dataframe to use.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="proposal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ds4114/NYC_Crime_Group32/edit/main/data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ds4114/NYC_Crime_Group32/blob/main/data.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
