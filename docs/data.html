<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data | NYC Crime</title>
  <meta name="description" content="Chapter 3 Data | NYC Crime" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data | NYC Crime" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data | NYC Crime" />
  
  
  

<meta name="author" content="Group 32: Abhiram Gaddam, Faizan Dogar, Devan Samant" />


<meta name="date" content="2022-12-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="proposal.html"/>
<link rel="next" href="results.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYC Crime</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="proposal.html"><a href="proposal.html"><i class="fa fa-check"></i><b>2</b> Proposal</a>
<ul>
<li class="chapter" data-level="2.1" data-path="proposal.html"><a href="proposal.html#research-topic"><i class="fa fa-check"></i><b>2.1</b> Research topic</a></li>
<li class="chapter" data-level="2.2" data-path="proposal.html"><a href="proposal.html#data-availability"><i class="fa fa-check"></i><b>2.2</b> Data availability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="proposal.html"><a href="proposal.html#content"><i class="fa fa-check"></i><b>2.2.1</b> <em>Content</em></a></li>
<li class="chapter" data-level="2.2.2" data-path="proposal.html"><a href="proposal.html#who-collects-the-data"><i class="fa fa-check"></i><b>2.2.2</b> <em>Who Collects The Data</em></a></li>
<li class="chapter" data-level="2.2.3" data-path="proposal.html"><a href="proposal.html#format-and-importation"><i class="fa fa-check"></i><b>2.2.3</b> <em>Format and Importation</em></a></li>
<li class="chapter" data-level="2.2.4" data-path="proposal.html"><a href="proposal.html#updates"><i class="fa fa-check"></i><b>2.2.4</b> <em>Updates</em></a></li>
<li class="chapter" data-level="2.2.5" data-path="proposal.html"><a href="proposal.html#expected-challenges"><i class="fa fa-check"></i><b>2.2.5</b> <em>Expected Challenges</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#source"><i class="fa fa-check"></i><b>3.1</b> Source</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#data-transformation-and-cleaning"><i class="fa fa-check"></i><b>3.2</b> Data Transformation and Cleaning</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#data-loading"><i class="fa fa-check"></i><b>3.2.1</b> Data Loading</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#bucket-crime-types"><i class="fa fa-check"></i><b>3.2.2</b> Bucket Crime Types</a></li>
<li class="chapter" data-level="3.2.3" data-path="data.html"><a href="data.html#datetime-transformation"><i class="fa fa-check"></i><b>3.2.3</b> Date/Time Transformation</a></li>
<li class="chapter" data-level="3.2.4" data-path="data.html"><a href="data.html#geo-location-fields"><i class="fa fa-check"></i><b>3.2.4</b> Geo-Location Fields</a></li>
<li class="chapter" data-level="3.2.5" data-path="data.html"><a href="data.html#other-derivations"><i class="fa fa-check"></i><b>3.2.5</b> Other Derivations</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#filter-table-for-relevance"><i class="fa fa-check"></i><b>3.3</b> Filter Table for Relevance</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#select-and-rename-columns-in-a-usuable-table"><i class="fa fa-check"></i><b>3.4</b> Select and Rename Columns in a Usuable Table</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#missing-value-analysis"><i class="fa fa-check"></i><b>3.5</b> Missing value analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>4</b> Results</a>
<ul>
<li class="chapter" data-level="4.1" data-path="results.html"><a href="results.html#crime-category-and-demographic-analysis"><i class="fa fa-check"></i><b>4.1</b> Crime category and Demographic analysis</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="results.html"><a href="results.html#race-analysis"><i class="fa fa-check"></i><b>4.1.1</b> Race Analysis</a></li>
<li class="chapter" data-level="4.1.2" data-path="results.html"><a href="results.html#gender-analysis"><i class="fa fa-check"></i><b>4.1.2</b> Gender Analysis</a></li>
<li class="chapter" data-level="4.1.3" data-path="results.html"><a href="results.html#counts-of-crime-by-borough"><i class="fa fa-check"></i><b>4.1.3</b> Counts of crime by borough</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="results.html"><a href="results.html#time-series"><i class="fa fa-check"></i><b>4.2</b> Time Series</a></li>
<li class="chapter" data-level="4.3" data-path="results.html"><a href="results.html#location-analysis"><i class="fa fa-check"></i><b>4.3</b> Location Analysis</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="results.html"><a href="results.html#spatial-distribution-of-all-crime-around-columbia-university"><i class="fa fa-check"></i><b>4.3.1</b> Spatial distribution of all crime around Columbia University</a></li>
<li class="chapter" data-level="4.3.2" data-path="results.html"><a href="results.html#histogram-of-crime-frequency-with-respect-to-increasing-radius-from-columbia"><i class="fa fa-check"></i><b>4.3.2</b> Histogram of crime frequency with respect to increasing radius from Columbia</a></li>
<li class="chapter" data-level="4.3.3" data-path="results.html"><a href="results.html#cumulative-crime-counts-with-respect-to-distance-from-columbia-university"><i class="fa fa-check"></i><b>4.3.3</b> Cumulative crime counts with respect to distance from Columbia University</a></li>
<li class="chapter" data-level="4.3.4" data-path="results.html"><a href="results.html#cumulative-and-incremental-density-of-crime-with-respect-to-distance-from-columbia"><i class="fa fa-check"></i><b>4.3.4</b> Cumulative and incremental density of crime with respect to distance from Columbia</a></li>
<li class="chapter" data-level="4.3.5" data-path="results.html"><a href="results.html#visualizing-incremental-density-of-crime-within-1000m-of-columbia"><i class="fa fa-check"></i><b>4.3.5</b> Visualizing incremental density of crime within 1000m of Columbia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>5</b> Interactive component</a>
<ul>
<li class="chapter" data-level="5.1" data-path="interactive-component.html"><a href="interactive-component.html#interactive-visualization-of-crime-around-columbia"><i class="fa fa-check"></i><b>5.1</b> Interactive Visualization of Crime Around Columbia</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC Crime</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="data.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="data.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="data.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geosphere)</span>
<span id="cb1-5"><a href="data.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(redav) <span class="co">#remotes::install_github(&quot;jtr13/redav&quot;)</span></span>
<span id="cb1-6"><a href="data.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="data.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-8"><a href="data.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="data.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-10"><a href="data.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-11"><a href="data.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lock5withR) </span>
<span id="cb1-12"><a href="data.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-13"><a href="data.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra)</span>
<span id="cb1-14"><a href="data.html#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="data.html#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb1-16"><a href="data.html#cb1-16" aria-hidden="true" tabindex="-1"></a> <span class="co">#  D. Kahle and H. Wickham. ggmap: Spatial Visualization with ggplot2. The R Journal, 5(1), 144-161. URL http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf</span></span>
<span id="cb1-17"><a href="data.html#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code></pre></div>
<div id="source" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Source<a href="data.html#source" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As discussed in the Proposal section, the data for this project comes from published crime reports. NYC Open Data (NYC Office of Technology and Innovation (OTI)) in conjunction with New York City Police Department (NYPD) makes public safety data available for anyone online. In particular they publish Complaint Data which contains felony, misdemeanor, and violation crimes reported to the NYPD from 2006 till present.</p>
<p>Year-to-Date (YTD) (2022-01 to 2022-09): <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243" class="uri">https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243</a></p>
<p>The dataset contains mostly categorical variables and dates with each row indicating a crime/violation. As of the last update on October 19, 2022, the YTD Dataset contains 397K rows and 36 columns. A data dictionary is provided by NYC Open Data at the link above.</p>
<p>Additional details can be found in the Proposal: <a href="https://ds4114.github.io/NYC_Crime_Group32/proposal.html#data-availability" class="uri">https://ds4114.github.io/NYC_Crime_Group32/proposal.html#data-availability</a></p>
</div>
<div id="data-transformation-and-cleaning" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Data Transformation and Cleaning<a href="data.html#data-transformation-and-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This .Rmd file contains the following sections:
-Data Loading: To show data was ingested into the environment
-Bucketing: To combine values in a derived field for simplifying graphs
-Date Transformations: To make strings into dates and extract time information
-Derived Geo Fields: To calculate distances between points
-Derive Other Fields: To derived other fields and perform minor cleaning operations</p>
<p>We then filter our data frame to relevant records, and then select key fields for ease-of-use. “Relevant” records are defined by time frame and crime category explained more below.</p>
<p>There is also a section at the end on missing data.</p>
<div id="data-loading" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Data Loading<a href="data.html#data-loading" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group32 - This file has been added to gitignore so it will not be uploaded. So we are on the same page and can run the same code, add the csv to your local project folder in a new subfolder &quot;data&quot;. </span></span>
<span id="cb2-2"><a href="data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>df_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;./data/NYPD_Complaint_Data_Current__Year_To_Date_.csv&#39;</span></span>
<span id="cb2-3"><a href="data.html#cb2-3" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">col_types=</span> <span class="fu">cols</span>(</span>
<span id="cb2-4"><a href="data.html#cb2-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">CMPLNT_NUM =</span> <span class="fu">col_character</span>() <span class="co">#was loading as number so numbers with letters were showing as null</span></span>
<span id="cb2-5"><a href="data.html#cb2-5" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb2-6"><a href="data.html#cb2-6" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb2-7"><a href="data.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df_raw)</span></span>
<span id="cb2-8"><a href="data.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#head(df_raw)</span></span>
<span id="cb2-9"><a href="data.html#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="data.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#make a copy of the raw data to manipulate</span></span>
<span id="cb2-11"><a href="data.html#cb2-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_raw  </span></code></pre></div>
</div>
<div id="bucket-crime-types" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Bucket Crime Types<a href="data.html#bucket-crime-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This code creates a new field to simplify the crime category to reduce the number of unique values.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data.html#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="data.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CRIME_CAT =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-3"><a href="data.html#cb3-3" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RAPE&quot;</span>, <span class="st">&quot;SEX CRIMES&quot;</span>, <span class="st">&quot;HARRASSMENT 2&quot;</span>, <span class="st">&quot;FELONY SEX CRIMES&quot;</span>, <span class="st">&quot;PROSTITUTION &amp; RELATED OFFENSES&quot;</span>) <span class="sc">~</span> <span class="st">&quot;SEX CRIMES&quot;</span>,</span>
<span id="cb3-4"><a href="data.html#cb3-4" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DANGEROUS DRUGS&quot;</span>,<span class="st">&quot;CANNABIS RELATED OFFENSES&quot;</span>,<span class="st">&quot;INTOXICATED &amp; IMPAIRED DRIVING&quot;</span>,<span class="st">&quot;ALCOHOLIC BEVERAGE CONTROL LAW&quot;</span>,<span class="st">&quot;INTOXICATED/IMPAIRED DRIVING&quot;</span>) <span class="sc">~</span> <span class="st">&quot;DRUG AND ALCOHOL RELATED&quot;</span>,</span>
<span id="cb3-5"><a href="data.html#cb3-5" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ROBBERY&quot;</span>,<span class="st">&quot;GRAND LARCENY&quot;</span>,<span class="st">&quot;THEFT-FRAUD&quot;</span>,<span class="st">&quot;PETIT LARCENY&quot;</span>,<span class="st">&quot;BURGLARY&quot;</span>,<span class="st">&quot;GRAND LARCENY OF MOTOR VEHICLE&quot;</span>,<span class="st">&quot;POSSESSION OF STOLEN PROPERTY&quot;</span>,<span class="st">&quot;THEFT OF SERVICES&quot;</span>,<span class="st">&quot;BURGLAR&#39;S TOOLS&quot;</span>,<span class="st">&quot;PETIT LARCENY OF MOTOR VEHICLE&quot;</span>,<span class="st">&quot;OTHER OFFENSES RELATED TO THEF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;THEFT OR BURGLARY&quot;</span>,</span>
<span id="cb3-6"><a href="data.html#cb3-6" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DANGEROUS WEAPONS&quot;</span>,<span class="st">&quot;MURDER &amp; NON-NEGL. MANSLAUGHTER&quot;</span>,<span class="st">&quot;KIDNAPPING &amp; RELATED OFFENSES&quot;</span>,<span class="st">&quot;HOMICIDE-NEGLIGENT,UNCLASSIFIE&quot;</span>,<span class="st">&quot;HOMICIDE-NEGLIGENT-VEHICLE&quot;</span>,<span class="st">&quot;KIDNAPPING&quot;</span>,<span class="st">&quot;FELONY ASSAULT&quot;</span>,<span class="st">&quot;ARSON&quot;</span>,<span class="st">&quot;ASSAULT 3 &amp; RELATED OFFENSES&quot;</span>,<span class="st">&quot;UNLAWFUL POSS. WEAP. ON SCHOOL&quot;</span>,<span class="st">&quot;MURDER &amp; NON-NEGL. MANSLAUGHTER&quot;</span>) <span class="sc">~</span> <span class="st">&quot;MAJOR VIOLENT CRIMES&quot;</span>,</span>
<span id="cb3-7"><a href="data.html#cb3-7" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;CRIMINAL MISCHIEF &amp; RELATED OF&quot;</span>,<span class="st">&quot;UNAUTHORIZED USE OF A VEHICLE&quot;</span>,<span class="st">&quot;FRAUDS&quot;</span>,<span class="st">&quot;OFFENSES AGAINST PUBLIC SAFETY&quot;</span>,<span class="st">&quot;DISORDERLY CONDUCT&quot;</span>,<span class="st">&quot;JOSTLING&quot;</span>,<span class="st">&quot;DISRUPTION OF A RELIGIOUS SERV&quot;</span>,<span class="st">&quot;ESCAPE 3&quot;</span>,<span class="st">&quot;OFF. AGNST PUB ORD SENSBLTY &amp;&quot;</span>,<span class="st">&quot;CRIMINAL TRESPASS&quot;</span>,<span class="st">&quot;VEHICLE AND TRAFFIC LAWS&quot;</span>,<span class="st">&quot;GAMBLING&quot;</span>,<span class="st">&quot;OFFENSES AGAINST THE PERSON&quot;</span>,<span class="st">&quot;OFFENSES INVOLVING FRAUD&quot;</span>,<span class="st">&quot;FRAUDULENT ACCOSTING&quot;</span>,<span class="st">&quot;ANTICIPATORY OFFENSES&quot;</span>,<span class="st">&quot;LOITERING/GAMBLING (CARDS, DIC&quot;</span>) <span class="sc">~</span> <span class="st">&quot;FRAUD/GAMBLING AND MISC&quot;</span>,</span>
<span id="cb3-8"><a href="data.html#cb3-8" aria-hidden="true" tabindex="-1"></a>    OFNS_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;NYS LAWS-UNCLASSIFIED FELONY&quot;</span>,<span class="st">&quot;MISCELLANEOUS PENAL LAW&quot;</span>,<span class="st">&quot;FORGERY&quot;</span>,<span class="st">&quot;OFFENSES AGAINST PUBLIC ADMINI&quot;</span>,<span class="st">&quot;CHILD ABANDONMENT/NON SUPPORT&quot;</span>,<span class="st">&quot;NYS LAWS-UNCLASSIFIED VIOLATION&quot;</span>,<span class="st">&quot;OTHER STATE LAWS&quot;</span>,<span class="st">&quot;OTHER STATE LAWS (NON PENAL LAW)&quot;</span>,<span class="st">&quot;NEW YORK CITY HEALTH CODE&quot;</span>,<span class="st">&quot;ADMINISTRATIVE CODE&quot;</span>,<span class="st">&quot;OTHER STATE LAWS (NON PENAL LA&quot;</span>,<span class="st">&quot;AGRICULTURE &amp; MRKTS LAW-UNCLASSIFIED&quot;</span>,<span class="st">&quot;ENDAN WELFARE INCOMP&quot;</span>,<span class="st">&quot;OFFENSES RELATED TO CHILDREN&quot;</span>) <span class="sc">~</span><span class="st">&quot;OTHER&quot;</span>))</span></code></pre></div>
<p>There are 5 values with missing “OFNS_DESC”. Since they have valid PD_CD and PD_DESC, we can impute these values from other columns with the same PD_CD.
-Two values are for obscenity - 594 PD_CD (categorized as sex crimes)
-One values for crime pos weap - 797 PD_CD (categorized as major violent crimes/dangerous weapons)
-One value for “place false bomb” - 648 PD_CD (categorized as other)
-One value for “noise” - 872 PD_CD (categorized as other)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data.html#cb4-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>CRIME_CAT[df<span class="sc">$</span>CMPLNT_NUM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;243170965&quot;</span>, <span class="st">&quot;245874611&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;OTHER&quot;</span></span>
<span id="cb4-2"><a href="data.html#cb4-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>CRIME_CAT[df<span class="sc">$</span>CMPLNT_NUM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;248613125&quot;</span>, <span class="st">&quot;248290778&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;SEX CRIMES&quot;</span></span>
<span id="cb4-3"><a href="data.html#cb4-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>CRIME_CAT[df<span class="sc">$</span>CMPLNT_NUM <span class="sc">%in%</span> (<span class="st">&quot;246605653&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;MAJOR VIOLENT CRIMES&quot;</span> <span class="co">#&quot;DANGEROUS WEAPONS&quot;</span></span>
<span id="cb4-4"><a href="data.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="data.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#No Nulls now</span></span>
<span id="cb4-6"><a href="data.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df[is.na(df$CRIME_CAT),])</span></span></code></pre></div>
</div>
<div id="datetime-transformation" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Date/Time Transformation<a href="data.html#datetime-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Per the data dictionary, there is both a “from_date” and a “to_date” when the exact time is unknown. There is also a “report date” for when the crime was reported. Using these fields in conjunction, we can derive a new clean field that is the assumed date of the incident. Assumptions: When there is a range, we will use the “from” date only because is populated well and will on average approximate the frequency of crime over time; when from_date is null, we will use the report_date (does not occur often, see Missing Data Analysis below).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data.html#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="data.html#cb5-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="data.html#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="co">#use from date and report date if null. If to_date then just use from date and we can argue it averages out since new reports will start as other end</span></span>
<span id="cb5-4"><a href="data.html#cb5-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Incident_Date_raw =</span> <span class="fu">case_when</span> (<span class="fu">is.null</span>(CMPLNT_FR_DT) <span class="sc">~</span> RPT_DT</span>
<span id="cb5-5"><a href="data.html#cb5-5" aria-hidden="true" tabindex="-1"></a>                                     ,CMPLNT_FR_DT <span class="sc">==</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> RPT_DT</span>
<span id="cb5-6"><a href="data.html#cb5-6" aria-hidden="true" tabindex="-1"></a>                                     ,<span class="cn">TRUE</span>  <span class="sc">~</span> CMPLNT_FR_DT</span>
<span id="cb5-7"><a href="data.html#cb5-7" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb5-8"><a href="data.html#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="co">#flag if estimated (ie from date is null or to date is populated)</span></span>
<span id="cb5-9"><a href="data.html#cb5-9" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">Incident_Date_Estimated_Flag =</span> <span class="fu">case_when</span> ( <span class="fu">is.null</span>(CMPLNT_FR_DT) <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb5-10"><a href="data.html#cb5-10" aria-hidden="true" tabindex="-1"></a>                                                     ,CMPLNT_FR_DT <span class="sc">==</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb5-11"><a href="data.html#cb5-11" aria-hidden="true" tabindex="-1"></a>                                                     ,<span class="sc">!</span><span class="fu">is.null</span>(CMPLNT_TO_DT) <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb5-12"><a href="data.html#cb5-12" aria-hidden="true" tabindex="-1"></a>                                                     ,CMPLNT_TO_DT <span class="sc">!=</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb5-13"><a href="data.html#cb5-13" aria-hidden="true" tabindex="-1"></a>                                                     ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;N&#39;</span></span>
<span id="cb5-14"><a href="data.html#cb5-14" aria-hidden="true" tabindex="-1"></a>                                                   )</span>
<span id="cb5-15"><a href="data.html#cb5-15" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb5-16"><a href="data.html#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="data.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to times</span></span>
<span id="cb5-18"><a href="data.html#cb5-18" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb5-19"><a href="data.html#cb5-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb5-20"><a href="data.html#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#creating date and time together for lubridate</span></span>
<span id="cb5-21"><a href="data.html#cb5-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">Incident_Date =</span> <span class="fu">as.Date</span>(Incident_Date_raw, <span class="at">format =</span> <span class="st">&#39;%m/%d/%Y&#39;</span>)</span>
<span id="cb5-22"><a href="data.html#cb5-22" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">Incident_Datetime =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(Incident_Date_raw,CMPLNT_FR_TM), <span class="at">format =</span> <span class="st">&#39;%m/%d/%Y %H:%M:%S&#39;</span>)</span>
<span id="cb5-23"><a href="data.html#cb5-23" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="data.html#cb5-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb5-25"><a href="data.html#cb5-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Incident_HourTime =</span> <span class="fu">hour</span>(Incident_Datetime) <span class="sc">+</span> <span class="fu">minute</span>(Incident_Datetime)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb5-26"><a href="data.html#cb5-26" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">Incident_Month =</span> <span class="fu">month</span>(Incident_Date)</span>
<span id="cb5-27"><a href="data.html#cb5-27" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">Incident_DayOfWeek =</span> <span class="fu">wday</span>(Incident_Date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-28"><a href="data.html#cb5-28" aria-hidden="true" tabindex="-1"></a>      )</span></code></pre></div>
</div>
<div id="geo-location-fields" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Geo-Location Fields<a href="data.html#geo-location-fields" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section uses a new package to calcluate the distance between two points in Lat/Long format. Here we are finding the distance from each crime to the center of the main Columbia campus to use later.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Location of Columbia - hardcoded for calculation</span></span>
<span id="cb6-2"><a href="data.html#cb6-2" aria-hidden="true" tabindex="-1"></a>CU_Latitude <span class="ot">=</span> <span class="fl">40.807384</span></span>
<span id="cb6-3"><a href="data.html#cb6-3" aria-hidden="true" tabindex="-1"></a>CU_Longitude <span class="ot">=</span> <span class="sc">-</span><span class="fl">73.963036</span></span>
<span id="cb6-4"><a href="data.html#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="data.html#cb6-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>dist_to_CU <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(x)<span class="fu">distm</span>(</span>
<span id="cb6-6"><a href="data.html#cb6-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(x[<span class="fu">which</span>( <span class="fu">colnames</span>(df)<span class="sc">==</span><span class="st">&quot;Longitude&quot;</span>)],x[<span class="fu">which</span>(<span class="fu">colnames</span>(df)<span class="sc">==</span><span class="st">&quot;Latitude&quot;</span>)])</span>
<span id="cb6-7"><a href="data.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  ,<span class="fu">c</span>(CU_Longitude,CU_Latitude)</span>
<span id="cb6-8"><a href="data.html#cb6-8" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">fun =</span> distGeo)</span>
<span id="cb6-9"><a href="data.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="other-derivations" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Other Derivations<a href="data.html#other-derivations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we add additional fields for more classification (explain more in the Results section), reclassify “null” to Unknown in specific instances, shorten values, and combine informaiton to simplify categories.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Update certain null fields. Setting race to null because there is already an &quot;Unknown&quot; category </span></span>
<span id="cb7-2"><a href="data.html#cb7-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>LOC_OF_OCCUR_DESC[df<span class="sc">$</span>LOC_OF_OCCUR_DESC<span class="sc">==</span><span class="st">&quot;(null)&quot;</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb7-3"><a href="data.html#cb7-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>BORO_NM[df<span class="sc">$</span>BORO_NM<span class="sc">==</span><span class="st">&quot;(null)&quot;</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb7-4"><a href="data.html#cb7-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>SUSP_RACE[df<span class="sc">$</span>SUSP_RACE<span class="sc">==</span><span class="st">&quot;(null)&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;UNKNOWN&quot;</span></span>
<span id="cb7-5"><a href="data.html#cb7-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>VIC_RACE[df<span class="sc">$</span>VIC_RACE<span class="sc">==</span><span class="st">&quot;(null)&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;UNKNOWN&quot;</span></span>
<span id="cb7-6"><a href="data.html#cb7-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>SUSP_SEX[df<span class="sc">$</span>SUSP_SEX<span class="sc">==</span><span class="st">&quot;(null)&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;U&quot;</span></span>
<span id="cb7-7"><a href="data.html#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="data.html#cb7-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="data.html#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb7-10"><a href="data.html#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="co">#get a flag for outside vs inside</span></span>
<span id="cb7-11"><a href="data.html#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Inside_Outside =</span> <span class="fu">case_when</span> ( </span>
<span id="cb7-12"><a href="data.html#cb7-12" aria-hidden="true" tabindex="-1"></a>                   LOC_OF_OCCUR_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;FRONT OF&quot;</span> , <span class="st">&quot;OPPOSITE OF&quot;</span> , <span class="st">&quot;REAR OF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;OUTSIDE&quot;</span></span>
<span id="cb7-13"><a href="data.html#cb7-13" aria-hidden="true" tabindex="-1"></a>                  ,LOC_OF_OCCUR_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;INSIDE&quot;</span>) <span class="sc">~</span> <span class="st">&quot;INSIDE&quot;</span></span>
<span id="cb7-14"><a href="data.html#cb7-14" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#,LOC_OF_OCCUR_DESC == &quot;(null)&quot; ~ NULL #doesnt run so added statement above</span></span>
<span id="cb7-15"><a href="data.html#cb7-15" aria-hidden="true" tabindex="-1"></a>                  ,<span class="cn">TRUE</span> <span class="sc">~</span> LOC_OF_OCCUR_DESC  </span>
<span id="cb7-16"><a href="data.html#cb7-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb7-17"><a href="data.html#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="co">#if victim was a person (not a business/govt)</span></span>
<span id="cb7-18"><a href="data.html#cb7-18" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">VIC_Individual_Flag =</span> <span class="fu">case_when</span> (</span>
<span id="cb7-19"><a href="data.html#cb7-19" aria-hidden="true" tabindex="-1"></a>                  VIC_SEX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;L&quot;</span>) <span class="sc">~</span> <span class="st">&#39;Y&#39;</span></span>
<span id="cb7-20"><a href="data.html#cb7-20" aria-hidden="true" tabindex="-1"></a>                  ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;N&#39;</span></span>
<span id="cb7-21"><a href="data.html#cb7-21" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb7-22"><a href="data.html#cb7-22" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">SUSP_AGE_GROUP =</span> <span class="fu">case_when</span> (</span>
<span id="cb7-23"><a href="data.html#cb7-23" aria-hidden="true" tabindex="-1"></a>            SUSP_AGE_GROUP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;&lt;18&#39;</span>,<span class="st">&#39;18-24&#39;</span>,<span class="st">&#39;25-44&#39;</span>,<span class="st">&#39;45-64&#39;</span>) <span class="sc">~</span> SUSP_AGE_GROUP</span>
<span id="cb7-24"><a href="data.html#cb7-24" aria-hidden="true" tabindex="-1"></a>            ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;UNKNOWN&#39;</span></span>
<span id="cb7-25"><a href="data.html#cb7-25" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb7-26"><a href="data.html#cb7-26" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">VIC_AGE_GROUP =</span> <span class="fu">case_when</span> (</span>
<span id="cb7-27"><a href="data.html#cb7-27" aria-hidden="true" tabindex="-1"></a>            VIC_AGE_GROUP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;&lt;18&#39;</span>,<span class="st">&#39;18-24&#39;</span>,<span class="st">&#39;25-44&#39;</span>,<span class="st">&#39;45-64&#39;</span>) <span class="sc">~</span> VIC_AGE_GROUP</span>
<span id="cb7-28"><a href="data.html#cb7-28" aria-hidden="true" tabindex="-1"></a>            ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;UNKNOWN&#39;</span></span>
<span id="cb7-29"><a href="data.html#cb7-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-30"><a href="data.html#cb7-30" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">SUSP_RACE_short =</span> <span class="fu">case_when</span> (</span>
<span id="cb7-31"><a href="data.html#cb7-31" aria-hidden="true" tabindex="-1"></a>             SUSP_RACE <span class="sc">==</span> <span class="st">&#39;AMERICAN INDIAN/ALASKAN NATIVE&#39;</span> <span class="sc">~</span> <span class="st">&#39;AI&#39;</span></span>
<span id="cb7-32"><a href="data.html#cb7-32" aria-hidden="true" tabindex="-1"></a>            ,SUSP_RACE <span class="sc">==</span> <span class="st">&#39;ASIAN / PACIFIC ISLANDER&#39;</span> <span class="sc">~</span> <span class="st">&#39;AP&#39;</span></span>
<span id="cb7-33"><a href="data.html#cb7-33" aria-hidden="true" tabindex="-1"></a>            ,SUSP_RACE <span class="sc">==</span> <span class="st">&#39;BLACK&#39;</span> <span class="sc">~</span> <span class="st">&#39;B&#39;</span></span>
<span id="cb7-34"><a href="data.html#cb7-34" aria-hidden="true" tabindex="-1"></a>            ,SUSP_RACE <span class="sc">==</span> <span class="st">&#39;BLACK HISPANIC&#39;</span> <span class="sc">~</span> <span class="st">&#39;BH&#39;</span></span>
<span id="cb7-35"><a href="data.html#cb7-35" aria-hidden="true" tabindex="-1"></a>            ,SUSP_RACE <span class="sc">==</span> <span class="st">&#39;UNKNOWN&#39;</span> <span class="sc">~</span> <span class="st">&#39;U&#39;</span></span>
<span id="cb7-36"><a href="data.html#cb7-36" aria-hidden="true" tabindex="-1"></a>            ,SUSP_RACE <span class="sc">==</span> <span class="st">&#39;WHITE&#39;</span> <span class="sc">~</span> <span class="st">&#39;W&#39;</span></span>
<span id="cb7-37"><a href="data.html#cb7-37" aria-hidden="true" tabindex="-1"></a>            ,SUSP_RACE <span class="sc">==</span> <span class="st">&#39;WHITE HISPANIC&#39;</span> <span class="sc">~</span> <span class="st">&#39;WH&#39;</span></span>
<span id="cb7-38"><a href="data.html#cb7-38" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-39"><a href="data.html#cb7-39" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">VIC_RACE_short =</span> <span class="fu">case_when</span> (</span>
<span id="cb7-40"><a href="data.html#cb7-40" aria-hidden="true" tabindex="-1"></a>             VIC_RACE <span class="sc">==</span> <span class="st">&#39;AMERICAN INDIAN/ALASKAN NATIVE&#39;</span> <span class="sc">~</span> <span class="st">&#39;AI&#39;</span></span>
<span id="cb7-41"><a href="data.html#cb7-41" aria-hidden="true" tabindex="-1"></a>            ,VIC_RACE <span class="sc">==</span> <span class="st">&#39;ASIAN / PACIFIC ISLANDER&#39;</span> <span class="sc">~</span> <span class="st">&#39;AP&#39;</span></span>
<span id="cb7-42"><a href="data.html#cb7-42" aria-hidden="true" tabindex="-1"></a>            ,VIC_RACE <span class="sc">==</span> <span class="st">&#39;BLACK&#39;</span> <span class="sc">~</span> <span class="st">&#39;B&#39;</span></span>
<span id="cb7-43"><a href="data.html#cb7-43" aria-hidden="true" tabindex="-1"></a>            ,VIC_RACE <span class="sc">==</span> <span class="st">&#39;BLACK HISPANIC&#39;</span> <span class="sc">~</span> <span class="st">&#39;BH&#39;</span></span>
<span id="cb7-44"><a href="data.html#cb7-44" aria-hidden="true" tabindex="-1"></a>            ,VIC_RACE <span class="sc">==</span> <span class="st">&#39;UNKNOWN&#39;</span> <span class="sc">~</span> <span class="st">&#39;U&#39;</span></span>
<span id="cb7-45"><a href="data.html#cb7-45" aria-hidden="true" tabindex="-1"></a>            ,VIC_RACE <span class="sc">==</span> <span class="st">&#39;WHITE&#39;</span> <span class="sc">~</span> <span class="st">&#39;W&#39;</span></span>
<span id="cb7-46"><a href="data.html#cb7-46" aria-hidden="true" tabindex="-1"></a>            ,VIC_RACE <span class="sc">==</span> <span class="st">&#39;WHITE HISPANIC&#39;</span> <span class="sc">~</span> <span class="st">&#39;WH&#39;</span></span>
<span id="cb7-47"><a href="data.html#cb7-47" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-48"><a href="data.html#cb7-48" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-49"><a href="data.html#cb7-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb7-50"><a href="data.html#cb7-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">Complaint_Count =</span> <span class="dv">1</span>     <span class="co">#maybe want to add like a intensity value or something?</span></span>
<span id="cb7-51"><a href="data.html#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO, make this field a little better/check values?</span></span>
<span id="cb7-52"><a href="data.html#cb7-52" aria-hidden="true" tabindex="-1"></a>         ,<span class="at">Premise_Derived =</span> <span class="fu">case_when</span> (</span>
<span id="cb7-53"><a href="data.html#cb7-53" aria-hidden="true" tabindex="-1"></a>           Inside_Outside <span class="sc">==</span> <span class="st">&#39;INSIDE&#39;</span> <span class="sc">~</span> <span class="st">&#39;INSIDE&#39;</span></span>
<span id="cb7-54"><a href="data.html#cb7-54" aria-hidden="true" tabindex="-1"></a>           ,PREM_TYP_DESC <span class="sc">==</span><span class="st">&quot;RESIDENCE - APT. HOUSE&quot;</span> <span class="sc">&amp;</span> (Inside_Outside <span class="sc">==</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">|</span> <span class="fu">is.null</span>(Inside_Outside)) <span class="sc">~</span> <span class="st">&#39;INSIDE&#39;</span></span>
<span id="cb7-55"><a href="data.html#cb7-55" aria-hidden="true" tabindex="-1"></a>           ,<span class="sc">!</span><span class="fu">is.null</span>(PARKS_NM) <span class="sc">&amp;</span> PARKS_NM <span class="sc">!=</span> <span class="st">&quot;(null)&quot;</span> <span class="sc">~</span> <span class="st">&#39;PARK&#39;</span></span>
<span id="cb7-56"><a href="data.html#cb7-56" aria-hidden="true" tabindex="-1"></a>           ,PREM_TYP_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;TRANSIT - NYC SUBWAY&quot;</span>,<span class="st">&quot;BUS (NYC TRANSIT)&quot;</span>,<span class="st">&quot;TRANSIT FACILITY (OTHER)&quot;</span>) <span class="sc">~</span> <span class="st">&#39;SUBWAY&#39;</span></span>
<span id="cb7-57"><a href="data.html#cb7-57" aria-hidden="true" tabindex="-1"></a>           ,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&#39;STREET&#39;</span></span>
<span id="cb7-58"><a href="data.html#cb7-58" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb7-59"><a href="data.html#cb7-59" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb7-60"><a href="data.html#cb7-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Borough_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-61"><a href="data.html#cb7-61" aria-hidden="true" tabindex="-1"></a>        BORO_NM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;BRONX&quot;</span>) <span class="sc">~</span> <span class="st">&quot;BX&quot;</span>,</span>
<span id="cb7-62"><a href="data.html#cb7-62" aria-hidden="true" tabindex="-1"></a>        BORO_NM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;BROOKLYN&quot;</span>) <span class="sc">~</span> <span class="st">&quot;BK&quot;</span>,</span>
<span id="cb7-63"><a href="data.html#cb7-63" aria-hidden="true" tabindex="-1"></a>        BORO_NM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MANHATTAN&quot;</span>) <span class="sc">~</span> <span class="st">&quot;MH&quot;</span>,</span>
<span id="cb7-64"><a href="data.html#cb7-64" aria-hidden="true" tabindex="-1"></a>        BORO_NM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;QUEENS&quot;</span>) <span class="sc">~</span> <span class="st">&quot;QN&quot;</span>,</span>
<span id="cb7-65"><a href="data.html#cb7-65" aria-hidden="true" tabindex="-1"></a>        BORO_NM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;STATEN ISLAND&quot;</span>) <span class="sc">~</span> <span class="st">&quot;SI&quot;</span>)</span>
<span id="cb7-66"><a href="data.html#cb7-66" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
</div>
</div>
<div id="filter-table-for-relevance" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Filter Table for Relevance<a href="data.html#filter-table-for-relevance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The raw data only contains crimes that were reported in 2022 even if they took place earlier. As we will show in the Results, this create a bias in the time series and this section creates a new data frame to filter out old records (as defined by derived field above; before 1/1/2022).
We also filter for only “relevant” crimes - i.e. excluding parking violations, noise compliants (those in the “Other” category)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data.html#cb8-1" aria-hidden="true" tabindex="-1"></a>df_filter <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(  Incident_Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&#39;2022/01/01&#39;</span>)  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="data.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (</span>
<span id="cb8-3"><a href="data.html#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>CRIME_CAT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;OTHER&quot;</span>)</span>
<span id="cb8-4"><a href="data.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-5"><a href="data.html#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="data.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO- distance filter?</span></span>
<span id="cb8-7"><a href="data.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df_filter)</span></span>
<span id="cb8-8"><a href="data.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(df_filter$CRIME_CAT)</span></span></code></pre></div>
<p>This improves the results as we will show in the next chapter. There are not many records that are excluded (396978 - 364298)</p>
</div>
<div id="select-and-rename-columns-in-a-usuable-table" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Select and Rename Columns in a Usuable Table<a href="data.html#select-and-rename-columns-in-a-usuable-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section simply chooses fields that are used in our analysis to simplify and reduce the overall size of the working data frame.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Not required</span></span>
<span id="cb9-2"><a href="data.html#cb9-2" aria-hidden="true" tabindex="-1"></a>df_key_fields <span class="ot">&lt;-</span> df_filter <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="data.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(  </span>
<span id="cb9-4"><a href="data.html#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Basic Info</span></span>
<span id="cb9-5"><a href="data.html#cb9-5" aria-hidden="true" tabindex="-1"></a>       CMPLNT_NUM</span>
<span id="cb9-6"><a href="data.html#cb9-6" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CRM_ATPT_CPTD_CD</span></span>
<span id="cb9-7"><a href="data.html#cb9-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Complaint_Count #derived</span></span>
<span id="cb9-8"><a href="data.html#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Date Info</span></span>
<span id="cb9-9"><a href="data.html#cb9-9" aria-hidden="true" tabindex="-1"></a>      ,Incident_Date_raw <span class="co">#derived</span></span>
<span id="cb9-10"><a href="data.html#cb9-10" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Date_Estimated_Flag #derived</span></span>
<span id="cb9-11"><a href="data.html#cb9-11" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Date #derived</span></span>
<span id="cb9-12"><a href="data.html#cb9-12" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Datetime #derived</span></span>
<span id="cb9-13"><a href="data.html#cb9-13" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_HourTime #derived</span></span>
<span id="cb9-14"><a href="data.html#cb9-14" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_Month #derived</span></span>
<span id="cb9-15"><a href="data.html#cb9-15" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Incident_DayOfWeek #derived</span></span>
<span id="cb9-16"><a href="data.html#cb9-16" aria-hidden="true" tabindex="-1"></a>      ,CMPLNT_FR_DT</span>
<span id="cb9-17"><a href="data.html#cb9-17" aria-hidden="true" tabindex="-1"></a>      ,CMPLNT_FR_TM</span>
<span id="cb9-18"><a href="data.html#cb9-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CMPLNT_TO_DT</span></span>
<span id="cb9-19"><a href="data.html#cb9-19" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CMPLNT_TO_TM</span></span>
<span id="cb9-20"><a href="data.html#cb9-20" aria-hidden="true" tabindex="-1"></a>      ,RPT_DT</span>
<span id="cb9-21"><a href="data.html#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Location Info</span></span>
<span id="cb9-22"><a href="data.html#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Inside_Outside #derived   #missing a lot (because derived on field below)</span></span>
<span id="cb9-23"><a href="data.html#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CU_Latitude #derived</span></span>
<span id="cb9-24"><a href="data.html#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,CU_Longitude #derived</span></span>
<span id="cb9-25"><a href="data.html#cb9-25" aria-hidden="true" tabindex="-1"></a>      ,dist_to_CU  <span class="co">#derived</span></span>
<span id="cb9-26"><a href="data.html#cb9-26" aria-hidden="true" tabindex="-1"></a>      ,Premise_Derived <span class="co">#derived</span></span>
<span id="cb9-27"><a href="data.html#cb9-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,ADDR_PCT_CD</span></span>
<span id="cb9-28"><a href="data.html#cb9-28" aria-hidden="true" tabindex="-1"></a>      ,BORO_NM</span>
<span id="cb9-29"><a href="data.html#cb9-29" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,HADEVELOPT</span></span>
<span id="cb9-30"><a href="data.html#cb9-30" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,HOUSING_PSA</span></span>
<span id="cb9-31"><a href="data.html#cb9-31" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,JURISDICTION_CODE</span></span>
<span id="cb9-32"><a href="data.html#cb9-32" aria-hidden="true" tabindex="-1"></a>      ,JURIS_DESC</span>
<span id="cb9-33"><a href="data.html#cb9-33" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,LOC_OF_OCCUR_DESC    #missing a lot (because of privacy)</span></span>
<span id="cb9-34"><a href="data.html#cb9-34" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PARKS_NM</span></span>
<span id="cb9-35"><a href="data.html#cb9-35" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PATROL_BORO</span></span>
<span id="cb9-36"><a href="data.html#cb9-36" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PD_CD</span></span>
<span id="cb9-37"><a href="data.html#cb9-37" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PD_DESC</span></span>
<span id="cb9-38"><a href="data.html#cb9-38" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,PREM_TYP_DESC</span></span>
<span id="cb9-39"><a href="data.html#cb9-39" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,STATION_NAME</span></span>
<span id="cb9-40"><a href="data.html#cb9-40" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,TRANSIT_DISTRICT</span></span>
<span id="cb9-41"><a href="data.html#cb9-41" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,X_COORD_CD</span></span>
<span id="cb9-42"><a href="data.html#cb9-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Y_COORD_CD</span></span>
<span id="cb9-43"><a href="data.html#cb9-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Latitude</span></span>
<span id="cb9-44"><a href="data.html#cb9-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,Longitude</span></span>
<span id="cb9-45"><a href="data.html#cb9-45" aria-hidden="true" tabindex="-1"></a>      ,Lat_Lon</span>
<span id="cb9-46"><a href="data.html#cb9-46" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,`New Georeferenced Column`</span></span>
<span id="cb9-47"><a href="data.html#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Crime Info </span></span>
<span id="cb9-48"><a href="data.html#cb9-48" aria-hidden="true" tabindex="-1"></a>      ,CRIME_CAT  <span class="co">#derived</span></span>
<span id="cb9-49"><a href="data.html#cb9-49" aria-hidden="true" tabindex="-1"></a>      ,VIC_Individual_Flag <span class="co">#derived</span></span>
<span id="cb9-50"><a href="data.html#cb9-50" aria-hidden="true" tabindex="-1"></a>      <span class="co">#,KY_CD</span></span>
<span id="cb9-51"><a href="data.html#cb9-51" aria-hidden="true" tabindex="-1"></a>      ,LAW_CAT_CD</span>
<span id="cb9-52"><a href="data.html#cb9-52" aria-hidden="true" tabindex="-1"></a>      ,OFNS_DESC</span>
<span id="cb9-53"><a href="data.html#cb9-53" aria-hidden="true" tabindex="-1"></a>      ,SUSP_AGE_GROUP</span>
<span id="cb9-54"><a href="data.html#cb9-54" aria-hidden="true" tabindex="-1"></a>      ,SUSP_RACE</span>
<span id="cb9-55"><a href="data.html#cb9-55" aria-hidden="true" tabindex="-1"></a>      ,SUSP_RACE_short</span>
<span id="cb9-56"><a href="data.html#cb9-56" aria-hidden="true" tabindex="-1"></a>      ,SUSP_SEX</span>
<span id="cb9-57"><a href="data.html#cb9-57" aria-hidden="true" tabindex="-1"></a>      ,VIC_AGE_GROUP</span>
<span id="cb9-58"><a href="data.html#cb9-58" aria-hidden="true" tabindex="-1"></a>      ,VIC_RACE</span>
<span id="cb9-59"><a href="data.html#cb9-59" aria-hidden="true" tabindex="-1"></a>      ,VIC_RACE_short</span>
<span id="cb9-60"><a href="data.html#cb9-60" aria-hidden="true" tabindex="-1"></a>      ,VIC_SEX</span>
<span id="cb9-61"><a href="data.html#cb9-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-62"><a href="data.html#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="data.html#cb9-63" aria-hidden="true" tabindex="-1"></a>df_key_fields<span class="sc">$</span>FCT_CRIME_CAT <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_key_fields<span class="sc">$</span>CRIME_CAT)</span>
<span id="cb9-64"><a href="data.html#cb9-64" aria-hidden="true" tabindex="-1"></a>df_key_fields<span class="sc">$</span>FCT_CRIME_CAT <span class="ot">&lt;-</span> <span class="fu">fct_infreq</span>(df_key_fields<span class="sc">$</span>CRIME_CAT)</span>
<span id="cb9-65"><a href="data.html#cb9-65" aria-hidden="true" tabindex="-1"></a>df_key_fields<span class="sc">$</span>VIC_SEX <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_key_fields<span class="sc">$</span>VIC_SEX) </span>
<span id="cb9-66"><a href="data.html#cb9-66" aria-hidden="true" tabindex="-1"></a>df_key_fields<span class="sc">$</span>VIC_SEX <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(df_key_fields<span class="sc">$</span>VIC_SEX, <span class="fu">c</span>(<span class="st">&#39;M&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;L&#39;</span>,<span class="st">&#39;E&#39;</span>,<span class="st">&#39;D&#39;</span>))</span>
<span id="cb9-67"><a href="data.html#cb9-67" aria-hidden="true" tabindex="-1"></a>df_key_fields<span class="sc">$</span>SUSP_SEX <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_key_fields<span class="sc">$</span>SUSP_SEX)</span>
<span id="cb9-68"><a href="data.html#cb9-68" aria-hidden="true" tabindex="-1"></a>df_key_fields<span class="sc">$</span>SUSP_SEX <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(df_key_fields<span class="sc">$</span>SUSP_SEX, <span class="fu">c</span>(<span class="st">&#39;M&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;L&#39;</span>,<span class="st">&#39;E&#39;</span>,<span class="st">&#39;D&#39;</span>))</span></code></pre></div>
</div>
<div id="missing-value-analysis" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Missing value analysis<a href="data.html#missing-value-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>–TODO - update this section, maybe create a table with # of nulls vs “(null)” for each field</p>
<p>First let us look at the raw data to see what things look like.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df_key_fields[is.na(df_key_fields$CMPLNT_NUM),])</span></span>
<span id="cb10-2"><a href="data.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#View(df[!is.na(df$TRANSIT_DISTRICT),])</span></span>
<span id="cb10-3"><a href="data.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df, <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-5-1.png" width="1440" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>( df[ , <span class="sc">!</span><span class="fu">colnames</span>(df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;TRANSIT_DISTRICT&quot;</span>,<span class="st">&quot;HOUSING_PSA&quot;</span>) ] , <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-5-2.png" width="1440" />
These charts are hard to read given the number of columns but it shows that most data is actually populated very well. There are two problem fields causing all of nulls but we can re-graph this without those and see that complete cases are at the top. However, this is still not accurate because there are string values in the data that say “(null)” or “Unknown” which would appear as populated. In any case, we do not need to clean and evaluate all columns, so let us work off of the new, filtered dataset (see below).
Side Note: We initially noticed the Complaint_Num was null often but this was due to containing alphanumeric characters but R loaded it as a number only.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(df_key_fields, <span class="at">percent =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-6-1.png" width="1440" />
The filtered data (relevant columns and rows only) is populated very well and this dataset accounts for improperly coded values where “(null)” will appear as NULL properly. We see there are a few blanks for lat/long and thus the related derived field, but otherwise we have a good data frame to use in the next chapter.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="proposal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ds4114/NYC_Crime_Group32/edit/main/data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ds4114/NYC_Crime_Group32/blob/main/data.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
